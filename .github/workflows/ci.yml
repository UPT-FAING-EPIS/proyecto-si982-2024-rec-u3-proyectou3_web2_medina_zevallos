name: Build and Deploy - ASP.NET

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    branches:
      - main
      - develop

jobs:
  build:
    runs-on: windows-latest  # Usamos un runner de Windows

    steps:
      # Paso 1: Checkout del c√≥digo
      - name: Checkout Repository
        uses: actions/checkout@v3

      # Paso 2: Configurar .NET SDK
      - name: Set up .NET SDK
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '6.0'  

      # Paso 3: Restaurar paquetes NuGet
      - name: Restore NuGet packages
        run: dotnet restore Sistema/SistemaEventos/SistemaEventos.sln

      # Paso 4: Construir el proyecto
      - name: Build project
        run: msbuild Sistema/SistemaEventos/SistemaEventos.sln /p:Configuration=Release /p:DeployOnBuild=true /p:OutputPath=Sistema/SistemaEventos/bin/Release/publish

      # Paso 5: Opcional: Ejecutar pruebas unitarias
      - name: Run Tests
        run: dotnet test Sistema/SistemaEventos/SistemaEventos.sln --configuration Release

      # Paso 6: Publicar los artefactos (si es necesario)
      - name: Upload artifact
        uses: actions/upload-artifact@v3
        with:
          name: publish-artifacts
          path: Sistema/SistemaEventos/bin/Release/publish
