name: Build and Test - ASP.NET

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    branches:
      - main
      - develop

jobs:
  build:
    runs-on: windows-latest  # Usamos Windows para trabajar con proyectos .NET

    steps:
    # Paso 1: Checkout del código
    - name: Checkout Repository
      uses: actions/checkout@v3
      # Esto asegura que el código más reciente esté disponible para los siguientes pasos

    # Paso 2: Configurar .NET SDK
    - name: Set up .NET SDK
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '6.0'  # Cambia la versión de .NET según tu proyecto

    # Paso 3: Restaurar dependencias NuGet
    - name: Restore NuGet packages
      run: dotnet restore Sistema/SistemaEventos/SistemaEventos.sln
      # Esto restaurará todos los paquetes NuGet necesarios para el proyecto

    # Paso 4: Compilar el proyecto
    - name: Build the project
      run: dotnet build Sistema/SistemaEventos/SistemaEventos.sln --configuration Release --no-restore
      # El flag --no-restore es para evitar restaurar de nuevo los paquetes si ya se restauraron

    # Paso 5: Ejecutar pruebas unitarias
    - name: Run Unit Tests
      run: dotnet test Sistema/SistemaEventos/SistemaEventos.sln --configuration Release
      # Aquí puedes agregar tu lógica para ejecutar las pruebas unitarias

    # Paso 6: Subir resultados de las pruebas (opcional)
    - name: Upload Test Results
      uses: actions/upload-artifact@v3
      with:
        name: test-results
        path: test_results.trx
        # Esto subirá los resultados de las pruebas como un artefacto para su análisis posterior
